## Step 2: Setup the Kubernetes Control Plane

Next, we are going to configure the Docker daemon to use systemd for the management of the containerâ€™s cgroups, copy the following block and paste it in the terminal window of each node {Control Plane, kube-02, kube-03}:

```
mkdir /etc/docker
cat <<EOF | sudo tee /etc/docker/daemon.json
{
  "exec-opts": ["native.cgroupdriver=systemd"],
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "100m"
  },
  "storage-driver": "overlay2"
}
EOF

systemctl enable docker
systemctl daemon-reload
systemctl restart docker
```

On the Control Plane node only, run this command in order to initialize the Kubernetes control plane:

```
kubeadm init --ignore-preflight-errors=all
```

This can take a minute or two to run.

Before we begin using the cluster, we need to configure the kubectl command line tool that let us control the cluster. For configuration, kubectl looks for a file named config in the $HOME/.kube directory.

Create the directory:

```
mkdir -p $HOME/.kube
```

Copy the config file generated by kubeadm to $HOME/.kube/:

```
cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
```

Change ownership of the file to the current logged in user:

```
chown $(id -u):$(id -g) $HOME/.kube/config
```

Your Kubernetes Control Plane has initialized successfully!
